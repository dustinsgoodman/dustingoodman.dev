---
import { getCollection } from 'astro:content';
import HomeLayout from '@/layouts/home.astro';
import HeroBanner from '@/components/HeroBanner.astro';
import AboutSection from '@/components/AboutSection.astro';
import BlogPreviewSection from '@/components/BlogPreviewSection.astro';

const recentBlogPosts = (
	await getCollection('blog', (post) => {
		return (
			import.meta.env.MODE !== 'production' ||
			post.data.draft !== true ||
			!!post.data.publishDate
		);
	})
)
	.sort(
		(a, b) =>
			new Date(b.data.publishDate).valueOf() -
			new Date(a.data.publishDate).valueOf()
	)
	.slice(0, 4);
---

<HomeLayout
	title="Welcome | Dustin Goodman"
	description="Personal website for Dustin Goodman. Contains blog posts and other content related to web development."
>
	<HeroBanner />
	<AboutSection />
	<BlogPreviewSection blogPosts={recentBlogPosts} />
</HomeLayout>
